{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"/home/dhpho/Programming/NCKH/admin-web/src/CallStaffNotification.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport \"./CallStaffNotification.css\";\nimport Bell from \"./Bell\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CallStaffNotification = () => {\n  _s();\n  const [callStaffs, setCallStaffs] = useState([]);\n  const [isVisible, setIsVisible] = useState(true);\n  const fetchCallStaffs = async () => {\n    try {\n      console.log(\"Đang gọi API get-call-staffs...\");\n      const response = await fetch(\"http://localhost:8080/api/users/get-call-staffs\", {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n      if (response.ok) {\n        const data = await response.json();\n        console.log(\"Dữ liệu nhận được:\", data);\n        setCallStaffs(data);\n      } else {\n        console.error(\"Lỗi khi lấy dữ liệu:\", response.statusText);\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi gọi API:\", error);\n    }\n  };\n  const updateCallStaff = async callStaffId => {\n    try {\n      console.log(\"Đang cập nhật callStaffId:\", callStaffId);\n      setCallStaffs(callStaffs.filter(staff => staff.CallStaffID !== callStaffId));\n      const response = await fetch(\"http://localhost:8080/api/users/update-call-staff\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          callStaffId: callStaffId\n        })\n      });\n      if (!response.ok) {\n        console.error(\"Lỗi khi cập nhật:\", response.statusText);\n        fetchCallStaffs();\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi gọi API cập nhật:\", error);\n      fetchCallStaffs();\n    }\n  };\n  useEffect(() => {\n    console.log(\"Component đã mount, gọi API lần đầu\");\n    fetchCallStaffs();\n    const intervalId = setInterval(() => {\n      console.log(\"Đang gọi API định kỳ...\");\n      fetchCallStaffs();\n    }, 500);\n    return () => {\n      console.log(\"Component unmount, xóa interval\");\n      clearInterval(intervalId);\n    };\n  }, []);\n  console.log(\"Rendering component với\", callStaffs.length, \"thông báo\");\n  console.log(\"isVisible:\", isVisible);\n  if (callStaffs.length === 0) {\n    console.log(\"Không có thông báo, không hiển thị gì\");\n    return null;\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: isVisible ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"call-staff-notification\",\n      style: {\n        display: \"block\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"notification-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"Th\\xF4ng b\\xE1o g\\u1ECDi nh\\xE2n vi\\xEAn (\", callStaffs.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"close-button\",\n          onClick: () => setIsVisible(false),\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"notification-content\",\n        children: callStaffs.map(staff => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"notification-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"notification-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"B\\xE0n:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 21\n              }, this), \" \", staff.TableID]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Tr\\u1EA1ng th\\xE1i:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 21\n              }, this), \" \", staff.Status]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Th\\u1EDDi gian:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 21\n              }, this), \" \", new Date(staff.CreatedAt).toLocaleTimeString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"complete-button\",\n            onClick: () => updateCallStaff(staff.CallStaffID),\n            children: \"\\u0110\\xE3 x\\u1EED l\\xFD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 17\n          }, this)]\n        }, staff.CallStaffID, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"notification-toggle-button\",\n      onClick: () => setIsVisible(true),\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"bell-icon\",\n        children: \"\\uD83D\\uDD14\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), callStaffs.length > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"notification-badge\",\n        children: callStaffs.length\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 37\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n_s(CallStaffNotification, \"a7CjGFIhqeSfCKze+9MR6Ont0Gc=\");\n_c = CallStaffNotification;\nexport default CallStaffNotification;\nvar _c;\n$RefreshReg$(_c, \"CallStaffNotification\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","useState","useEffect","Bell","jsxDEV","_jsxDEV","Fragment","_Fragment","CallStaffNotification","callStaffs","setCallStaffs","isVisible","setIsVisible","fetchCallStaffs","console","log","response","fetch","method","headers","ok","data","json","error","statusText","updateCallStaff","callStaffId","filter","staff","CallStaffID","body","JSON","stringify","intervalId","setInterval","clearInterval","length","children","className","style","display","fileName","lineNumber","columnNumber","onClick","map","TableID","Status","Date","CreatedAt","toLocaleTimeString","_c","$RefreshReg$"],"sources":["/home/dhpho/Programming/NCKH/admin-web/src/CallStaffNotification.js"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport \"./CallStaffNotification.css\"\nimport Bell from \"./Bell\"\n\nconst CallStaffNotification = () => {\n  const [callStaffs, setCallStaffs] = useState([])\n  const [isVisible, setIsVisible] = useState(true)\n\n  const fetchCallStaffs = async () => {\n    try {\n      console.log(\"Đang gọi API get-call-staffs...\")\n\n      const response = await fetch(\"http://localhost:8080/api/users/get-call-staffs\", {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      })\n      if (response.ok) {\n        const data = await response.json()\n        console.log(\"Dữ liệu nhận được:\", data)\n        setCallStaffs(data)\n      } else {\n        console.error(\"Lỗi khi lấy dữ liệu:\", response.statusText)\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi gọi API:\", error)\n    }\n  }\n\n  const updateCallStaff = async (callStaffId) => {\n    try {\n      console.log(\"Đang cập nhật callStaffId:\", callStaffId)\n\n      setCallStaffs(callStaffs.filter((staff) => staff.CallStaffID !== callStaffId))\n\n      const response = await fetch(\"http://localhost:8080/api/users/update-call-staff\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ callStaffId: callStaffId }),\n      })\n\n      if (!response.ok) {\n        console.error(\"Lỗi khi cập nhật:\", response.statusText)\n        fetchCallStaffs()\n      }\n    } catch (error) {\n      console.error(\"Lỗi khi gọi API cập nhật:\", error)\n      fetchCallStaffs()\n    }\n  }\n\n  useEffect(() => {\n    console.log(\"Component đã mount, gọi API lần đầu\")\n    fetchCallStaffs()\n\n    const intervalId = setInterval(() => {\n      console.log(\"Đang gọi API định kỳ...\")\n      fetchCallStaffs()\n    }, 500)\n\n    return () => {\n      console.log(\"Component unmount, xóa interval\")\n      clearInterval(intervalId)\n    }\n  }, [])\n\n  console.log(\"Rendering component với\", callStaffs.length, \"thông báo\")\n  console.log(\"isVisible:\", isVisible)\n\n  if (callStaffs.length === 0) {\n    console.log(\"Không có thông báo, không hiển thị gì\")\n    return null\n  }\n\n  return (\n    <>\n      {isVisible ? (\n        <div className=\"call-staff-notification\" style={{ display: \"block\" }}>\n          <div className=\"notification-header\">\n            <h3>Thông báo gọi nhân viên ({callStaffs.length})</h3>\n            <button className=\"close-button\" onClick={() => setIsVisible(false)}>\n              ×\n            </button>\n          </div>\n          <div className=\"notification-content\">\n            {callStaffs.map((staff) => (\n              <div key={staff.CallStaffID} className=\"notification-item\">\n                <div className=\"notification-info\">\n                  <p>\n                    <strong>Bàn:</strong> {staff.TableID}\n                  </p>\n                  <p>\n                    <strong>Trạng thái:</strong> {staff.Status}\n                  </p>\n                  <p>\n                    <strong>Thời gian:</strong> {new Date(staff.CreatedAt).toLocaleTimeString()}\n                  </p>\n                </div>\n                <button className=\"complete-button\" onClick={() => updateCallStaff(staff.CallStaffID)}>\n                  Đã xử lý\n                </button>\n              </div>\n            ))}\n          </div>\n        </div>\n      ) : (\n        <div className=\"notification-toggle-button\" onClick={() => setIsVisible(true)}>\n          <span className=\"bell-icon\">🔔</span>\n          {callStaffs.length > 0 && <span className=\"notification-badge\">{callStaffs.length}</span>}\n        </div>\n      )}\n    </>\n  )\n}\n\nexport default CallStaffNotification\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}